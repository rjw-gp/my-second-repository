This is the second try to do this right.